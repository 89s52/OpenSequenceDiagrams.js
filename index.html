<html>
<head>
	<title>Open Sequence Diagrams</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
	<script src="OpenSequenceDiagrams.js" type="text/javascript"></script>
	<meta charset="UTF-8">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
	<style type="text/css">
		h1{text-align:center;}
		body{font-family: 'Open Sans', sans-serif;}
	</style>
</head>
<body>
	<h1>Open Sequence Diagrams</h1>
	<p>
		Bienvenue sur open sequence diagrams. Cet outil permet de créer des diagrames de séquence à partir d'une notation simple.
		Cette notation est inspirée du très bon <a href="http://www.websequencediagrams.com/examples.html" title="Projet source de l'inspiration">Web Sequence Diagrams</a> (qui n'est malheureusement pas open source).
	</p>
	<p>
		Pour l'instant, seul un sous ensemble du langage utilisé par Web Sequence Diagrams est implémenté...<br/>
		Commencez dès maintenant à tester :
	</p>
	<textarea id="source" style="width:100%; height:25%;">
participant Bob
participant Alice
participant "I have a really\nlong name" as L

Alice->Bob: Authentication Request
Bob-->Alice: Authentication Response
Bob->L: Log transaction
Alice->Alice: This is a signal to self.\nIt also demonstrates \nmultiline \ntext.</textarea><br/>
	<a href="#" id="refresh">Refresh</a> <a href="#" id="open">Download</a><br/>

	<div id="errors">
	</div><br/>
	<div id="drawing">
	</div>

<script>
function parseText() {
	var schema = new Schema();
	
	$("#drawing").html("<p>loading...</p>");
	$("#errors").html("<p>No errors</p>");
	
	var retour = schema.parseLines($("#source").val());
	if(retour != "")
		$("#errors").html("<p>" + retour + "</p>");
	
	$("#drawing").html(schema.getSVG());
}

function openSVG() {
	open("data:image/svg+xml," + encodeURIComponent($("#drawing").html()));
}

$(document).ready(function(){
	$("#refresh").click(function(event) {
		parseText();
		event.preventDefault();
	});
	$("#open").click(function(event) {
		openSVG();
		event.preventDefault();
	});
});
</script>
</body>
</html>
